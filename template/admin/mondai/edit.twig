{% extends 'admin/_layout.twig' %}

{% block admin_body %}
    <script src="/script/happy.js"></script>
    <h2>Редактирование задачи</h2>
    <form
        id="admin_mondai_edit"
        action="{{ path('admin_mondai_edit', { 'mondai_id_old' : mondai_id_old }) }}?page={{ page }}"
        method="post"
    >
        <input type="hidden" name="csrf" value="{{ csrf }}"/>
        <p>№<input name="mondai_id_new" required value="{{ mondai.mondai_id|default(mondai_id_new) }}" maxlength="3"/>.
            <input name="title"         required value="{{ mondai.title|default('') }}"/>
        </p>
        <p><textarea name="content" required rows="13">{{ mondai.content|default('') }}</textarea></p>
        <p>
            <input type="submit" value="Сохранить"/>
            <input type="button" value="Отмена"/>
            {# <input type="button" value="Удалить"/> #}
        </p>
    </form>
    <script>
        $('#admin_mondai_edit').isHappy({
            fields : {
                'input[name=mondai_id_new]' : {
                    required : true,
                    message  : 'Номер должен быть целым положительным числом',
                    test : function checkMondaiId(mondaiId) {
                        return !! (mondaiId + '').match(/^\d{1,3}$/) && parseInt(mondaiId, 10) > 0;
                    }
                },
                'input[name=title]' : {
                    required : true,
                    message  : 'Заголовок должен быть не пуст'
                },
                'textarea[name=content]' : {
                    required : true,
                    message  : 'Текст задачи должен быть не пуст'
                }
            }
        });
    </script>
{% endblock %}
